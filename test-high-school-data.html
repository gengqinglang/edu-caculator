<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜ä¸­è´¹ç”¨æ•°æ®æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
        }
        
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .test-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 16px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }
        
        .test-case {
            margin-bottom: 16px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .test-button:hover {
            background: #2980b9;
        }
        
        .test-result {
            font-family: 'Monaco', 'Menlo', monospace;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 12px;
            border-radius: 6px;
            white-space: pre-wrap;
            margin-top: 8px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .success { color: #27ae60; font-weight: 600; }
        .error { color: #e74c3c; font-weight: 600; }
        .info { color: #3498db; font-weight: 600; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        th {
            background-color: #f2f2f2;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª é«˜ä¸­è´¹ç”¨æ•°æ®æµ‹è¯•</h1>
    
    <div class="test-section">
        <div class="test-title">ğŸ“‹ æµ‹è¯•è¯´æ˜</div>
        <p>æœ¬é¡µé¢ç”¨äºæµ‹è¯•æ–°åˆ›å»ºçš„é«˜ä¸­è´¹ç”¨æ•°æ®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ï¼š</p>
        <ul>
            <li><strong>æ•°æ®æ–‡ä»¶åŠ è½½</strong>ï¼šéªŒè¯high-school-cost-data.jsæ­£ç¡®åŠ è½½</li>
            <li><strong>é€‚é…å™¨åŠŸèƒ½</strong>ï¼šéªŒè¯HighSchoolAdapteræ­£å¸¸å·¥ä½œ</li>
            <li><strong>è´¹ç”¨è®¡ç®—</strong>ï¼šéªŒè¯ä¸åŒå­¦æ ¡ç±»å‹å’Œæ•™è‚²é£æ ¼çš„è´¹ç”¨è®¡ç®—</li>
            <li><strong>æµ·å¤–é«˜ä¸­</strong>ï¼šéªŒè¯æµ·å¤–é«˜ä¸­è´¹ç”¨æ•°æ®</li>
        </ul>
    </div>

    <div class="test-section">
        <div class="test-title">ğŸ” 1. æ•°æ®æ–‡ä»¶åŠ è½½æµ‹è¯•</div>
        
        <div class="test-case">
            <div class="test-label">æµ‹è¯•æ•°æ®æ–‡ä»¶å’Œä¾èµ–æ˜¯å¦æ­£ç¡®åŠ è½½</div>
            <button class="test-button" onclick="testDataLoading()">æµ‹è¯•æ•°æ®åŠ è½½</button>
            <div id="dataLoadingResult" class="test-result"></div>
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">ğŸ« 2. å›½å†…é«˜ä¸­è´¹ç”¨æµ‹è¯•</div>
        
        <div class="test-case">
            <div class="test-label">æµ‹è¯•å…¬ç«‹é«˜ä¸­è´¹ç”¨æ•°æ®</div>
            <button class="test-button" onclick="testDomesticPublic()">æµ‹è¯•å…¬ç«‹é«˜ä¸­</button>
            <div id="domesticPublicResult" class="test-result"></div>
        </div>
        
        <div class="test-case">
            <div class="test-label">æµ‹è¯•å›½é™…éƒ¨/å›½é™…é«˜ä¸­è´¹ç”¨æ•°æ®</div>
            <button class="test-button" onclick="testInternationalSchools()">æµ‹è¯•å›½é™…æ•™è‚²</button>
            <div id="internationalResult" class="test-result"></div>
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">ğŸŒ 3. æµ·å¤–é«˜ä¸­è´¹ç”¨æµ‹è¯•</div>
        
        <div class="test-case">
            <div class="test-label">æµ‹è¯•ä¸åŒå›½å®¶çš„æµ·å¤–é«˜ä¸­è´¹ç”¨</div>
            <button class="test-button" onclick="testOverseasSchools()">æµ‹è¯•æµ·å¤–é«˜ä¸­</button>
            <div id="overseasResult" class="test-result"></div>
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">ğŸ¯ 4. æ•™è‚²é£æ ¼å½±å“æµ‹è¯•</div>
        
        <div class="test-case">
            <div class="test-label">æµ‹è¯•æ•™è‚²é£æ ¼å¯¹å¼¹æ€§è´¹ç”¨çš„å½±å“</div>
            <button class="test-button" onclick="testEducationStyleImpact()">æµ‹è¯•æ•™è‚²é£æ ¼</button>
            <div id="educationStyleResult" class="test-result"></div>
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">ğŸ’° 5. è´¹ç”¨è®¡ç®—éªŒè¯</div>
        
        <div class="test-case">
            <div class="test-label">æµ‹è¯•è´¹ç”¨è®¡ç®—é€»è¾‘å’Œå…¼å®¹æ€§</div>
            <button class="test-button" onclick="testCostCalculation()">æµ‹è¯•è´¹ç”¨è®¡ç®—</button>
            <div id="costCalculationResult" class="test-result"></div>
        </div>
    </div>

    <!-- å¼•å…¥å¿…è¦çš„JSæ–‡ä»¶ -->
    <script src="city-tier-mapping.js"></script>
    <script src="high-school-cost-data.js"></script>
    <script src="high-school-adapter.js"></script>

    <script>
        let highSchoolAdapter;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            try {
                highSchoolAdapter = new HighSchoolAdapter();
                console.log('âœ… é«˜ä¸­é€‚é…å™¨åˆå§‹åŒ–æˆåŠŸ');
            } catch (error) {
                console.error('âŒ é«˜ä¸­é€‚é…å™¨åˆå§‹åŒ–å¤±è´¥:', error);
            }
        });

        function testDataLoading() {
            const result = document.getElementById('dataLoadingResult');
            try {
                const tests = {
                    "HIGH_SCHOOL_COST_DATAåŠ è½½": typeof HIGH_SCHOOL_COST_DATA !== 'undefined',
                    "getCityTierå‡½æ•°åŠ è½½": typeof getCityTier !== 'undefined',
                    "HighSchoolAdapterç±»åŠ è½½": typeof HighSchoolAdapter !== 'undefined',
                    "é€‚é…å™¨å®ä¾‹åˆ›å»º": highSchoolAdapter !== undefined,
                    "isStageSupportedæ–¹æ³•": highSchoolAdapter && typeof highSchoolAdapter.isStageSupported === 'function',
                    "æ•°æ®ç»“æ„éªŒè¯": HIGH_SCHOOL_COST_DATA && HIGH_SCHOOL_COST_DATA.metadata && HIGH_SCHOOL_COST_DATA.ä¸€çº¿åŸå¸‚
                };
                
                const success = Object.values(tests).every(v => v === true);
                result.textContent = JSON.stringify({
                    "æµ‹è¯•ç»“æœ": success ? "âœ… æ‰€æœ‰ä¾èµ–æ­£ç¡®åŠ è½½" : "âŒ éƒ¨åˆ†ä¾èµ–æœªåŠ è½½",
                    "è¯¦ç»†æ£€æŸ¥": tests,
                    "æ•°æ®ç‰ˆæœ¬": HIGH_SCHOOL_COST_DATA?.metadata?.version,
                    "æ•°æ®æ¥æº": HIGH_SCHOOL_COST_DATA?.metadata?.dataSource
                }, null, 2);
                result.style.color = success ? '#27ae60' : '#e74c3c';
            } catch (error) {
                result.textContent = 'âŒ æµ‹è¯•å¤±è´¥: ' + error.message;
                result.style.color = '#e74c3c';
            }
        }

        function testDomesticPublic() {
            const result = document.getElementById('domesticPublicResult');
            try {
                if (!highSchoolAdapter) {
                    throw new Error('é€‚é…å™¨æœªåˆå§‹åŒ–');
                }
                
                const testCases = [
                    { city: 'beijing', level: 'domesticPublic', style: 'relaxed', desc: 'åŒ—äº¬å…¬ç«‹é«˜ä¸­-ä½›ç³»' },
                    { city: 'shanghai', level: 'domesticPublic', style: 'balanced', desc: 'ä¸Šæµ·å…¬ç«‹é«˜ä¸­-å¹³è¡¡' },
                    { city: 'chengdu', level: 'domesticPublic', style: 'intensive', desc: 'æˆéƒ½å…¬ç«‹é«˜ä¸­-é¸¡å¨ƒ' }
                ];
                
                const results = {};
                
                testCases.forEach(testCase => {
                    try {
                        const costData = highSchoolAdapter.getCostData(
                            'high',
                            testCase.level,
                            testCase.city,
                            '',
                            testCase.style
                        );
                        
                        const calculation = highSchoolAdapter.calculateTotalCost(costData, 3);
                        
                        results[testCase.desc] = {
                            "åŸå¸‚ç­‰çº§": costData.cityTier,
                            "å­¦è´¹": costData.costs?.å­¦è´¹?.amount,
                            "ä½å®¿è´¹": costData.costs?.ä½å®¿è´¹?.amount,
                            "é¤è´¹": costData.costs?.é¤è´¹?.amount,
                            "è¡¥è¯¾è¾…å¯¼è´¹": costData.costs?.è¡¥è¯¾è¾…å¯¼è´¹?.amount,
                            "3å¹´æ€»è´¹ç”¨": calculation.totalCost,
                            "å¹´å‡è´¹ç”¨": calculation.yearlyTotal
                        };
                    } catch (error) {
                        results[testCase.desc] = "âŒ " + error.message;
                    }
                });
                
                result.textContent = JSON.stringify(results, null, 2);
                result.style.color = '#27ae60';
            } catch (error) {
                result.textContent = 'âŒ æµ‹è¯•å¤±è´¥: ' + error.message;
                result.style.color = '#e74c3c';
            }
        }

        function testInternationalSchools() {
            const result = document.getElementById('internationalResult');
            try {
                if (!highSchoolAdapter) {
                    throw new Error('é€‚é…å™¨æœªåˆå§‹åŒ–');
                }
                
                const testCases = [
                    { city: 'beijing', level: 'internationalPublic', style: 'balanced', desc: 'åŒ—äº¬å…¬ç«‹å›½é™…éƒ¨-å¹³è¡¡' },
                    { city: 'shanghai', level: 'internationalSchool', style: 'intensive', desc: 'ä¸Šæµ·å›½é™…é«˜ä¸­-é¸¡å¨ƒ' }
                ];
                
                const results = {};
                
                testCases.forEach(testCase => {
                    try {
                        const costData = highSchoolAdapter.getCostData(
                            'high',
                            testCase.level,
                            testCase.city,
                            '',
                            testCase.style
                        );
                        
                        const calculation = highSchoolAdapter.calculateTotalCost(costData, 3);
                        
                        results[testCase.desc] = {
                            "åŸå¸‚ç­‰çº§": costData.cityTier,
                            "å­¦è´¹": costData.costs?.å­¦è´¹?.amount,
                            "æ ‡åŒ–è€ƒè¯•è´¹": costData.costs?.æ ‡åŒ–è€ƒè¯•è´¹?.amount,
                            "èƒŒæ™¯æå‡è´¹": costData.costs?.èƒŒæ™¯æå‡è´¹?.amount,
                            "ç•™å­¦ä¸­ä»‹è´¹": costData.costs?.ç•™å­¦ä¸­ä»‹è´¹?.amount,
                            "3å¹´æ€»è´¹ç”¨": calculation.totalCost,
                            "å¹´å‡è´¹ç”¨": calculation.yearlyTotal
                        };
                    } catch (error) {
                        results[testCase.desc] = "âŒ " + error.message;
                    }
                });
                
                result.textContent = JSON.stringify(results, null, 2);
                result.style.color = '#27ae60';
            } catch (error) {
                result.textContent = 'âŒ æµ‹è¯•å¤±è´¥: ' + error.message;
                result.style.color = '#e74c3c';
            }
        }

        function testOverseasSchools() {
            const result = document.getElementById('overseasResult');
            try {
                if (!highSchoolAdapter) {
                    throw new Error('é€‚é…å™¨æœªåˆå§‹åŒ–');
                }
                
                const countries = ['usa', 'uk', 'canada', 'australia', 'singapore'];
                const results = {};
                
                countries.forEach(country => {
                    try {
                        const costData = highSchoolAdapter.getCostData(
                            'high',
                            'overseas',
                            '',
                            country,
                            'balanced'
                        );
                        
                        const calculation = highSchoolAdapter.calculateTotalCost(costData, 3);
                        
                        results[costData.level] = {
                            "å­¦è´¹": costData.costs?.å­¦è´¹?.amount,
                            "ä½å®¿è´¹": costData.costs?.ä½å®¿è´¹?.amount,
                            "åŒ»ç–—ä¿é™©": costData.costs?.åŒ»ç–—ä¿é™©è´¹?.amount,
                            "ç›‘æŠ¤äººè´¹": costData.costs?.ç›‘æŠ¤äººè´¹?.amount,
                            "ç”Ÿæ´»è´¹": costData.costs?.ç”Ÿæ´»è´¹?.amount,
                            "3å¹´æ€»è´¹ç”¨": calculation.totalCost,
                            "å¹´å‡è´¹ç”¨": calculation.yearlyTotal
                        };
                    } catch (error) {
                        results[country] = "âŒ " + error.message;
                    }
                });
                
                result.textContent = JSON.stringify(results, null, 2);
                result.style.color = '#27ae60';
            } catch (error) {
                result.textContent = 'âŒ æµ‹è¯•å¤±è´¥: ' + error.message;
                result.style.color = '#e74c3c';
            }
        }

        function testEducationStyleImpact() {
            const result = document.getElementById('educationStyleResult');
            try {
                if (!highSchoolAdapter) {
                    throw new Error('é€‚é…å™¨æœªåˆå§‹åŒ–');
                }
                
                const styles = ['relaxed', 'balanced', 'intensive'];
                const results = {};
                
                // æµ‹è¯•å…¬ç«‹é«˜ä¸­çš„è¡¥è¯¾è´¹å·®å¼‚
                results["å…¬ç«‹é«˜ä¸­è¡¥è¯¾è´¹å¯¹æ¯”"] = {};
                styles.forEach(style => {
                    const costData = highSchoolAdapter.getCostData('high', 'domesticPublic', 'beijing', '', style);
                    results["å…¬ç«‹é«˜ä¸­è¡¥è¯¾è´¹å¯¹æ¯”"][`${style}é£æ ¼`] = costData.costs?.è¡¥è¯¾è¾…å¯¼è´¹?.amount;
                });
                
                // æµ‹è¯•å›½é™…éƒ¨çš„å¼¹æ€§è´¹ç”¨å·®å¼‚
                results["å›½é™…éƒ¨å¼¹æ€§è´¹ç”¨å¯¹æ¯”"] = {};
                styles.forEach(style => {
                    const costData = highSchoolAdapter.getCostData('high', 'internationalPublic', 'beijing', '', style);
                    results["å›½é™…éƒ¨å¼¹æ€§è´¹ç”¨å¯¹æ¯”"][`${style}é£æ ¼`] = {
                        "æ ‡åŒ–è€ƒè¯•è´¹": costData.costs?.æ ‡åŒ–è€ƒè¯•è´¹?.amount,
                        "èƒŒæ™¯æå‡è´¹": costData.costs?.èƒŒæ™¯æå‡è´¹?.amount,
                        "ç•™å­¦ä¸­ä»‹è´¹": costData.costs?.ç•™å­¦ä¸­ä»‹è´¹?.amount
                    };
                });
                
                result.textContent = JSON.stringify(results, null, 2);
                result.style.color = '#27ae60';
            } catch (error) {
                result.textContent = 'âŒ æµ‹è¯•å¤±è´¥: ' + error.message;
                result.style.color = '#e74c3c';
            }
        }

        function testCostCalculation() {
            const result = document.getElementById('costCalculationResult');
            try {
                if (!highSchoolAdapter) {
                    throw new Error('é€‚é…å™¨æœªåˆå§‹åŒ–');
                }
                
                // æµ‹è¯•è®¡ç®—åŠŸèƒ½å’Œå…¼å®¹æ€§
                const costData = highSchoolAdapter.getCostData('high', 'internationalSchool', 'beijing', '', 'intensive');
                const calculation = highSchoolAdapter.calculateTotalCost(costData, 3);
                
                const tests = {
                    "è´¹ç”¨æ•°æ®è·å–": !!costData.costs,
                    "æ€»è´¹ç”¨è®¡ç®—": typeof calculation.totalCost === 'number',
                    "å¹´å‡è´¹ç”¨è®¡ç®—": typeof calculation.yearlyTotal === 'number',
                    "ä¸€æ¬¡æ€§è´¹ç”¨è®¡ç®—": typeof calculation.oneTimeCost === 'number',
                    "è¯¦ç»†è´¹ç”¨æ˜ç»†": !!calculation.details,
                    "å…¼å®¹æ€§summaryå¯¹è±¡": !!calculation.summary,
                    "å…¼å®¹æ€§breakdownå¯¹è±¡": !!calculation.breakdown,
                    "å…ƒæ•°æ®åŒ…å«": !!calculation.metadata,
                    "periodicTotalä¸€è‡´æ€§": calculation.summary.periodicTotal === calculation.totalCost,
                    "è´¹ç”¨é¡¹æ•°é‡åˆç†": Object.keys(costData.costs).length >= 4
                };
                
                const success = Object.values(tests).every(v => v === true);
                
                const results = {
                    "å…¼å®¹æ€§æµ‹è¯•": success ? "âœ… é€šè¿‡" : "âŒ å¤±è´¥",
                    "æµ‹è¯•è¯¦æƒ…": tests,
                    "ç¤ºä¾‹è®¡ç®—ç»“æœ": {
                        "å­¦æ ¡ç±»å‹": costData.level,
                        "åŸå¸‚ç­‰çº§": costData.cityTier,
                        "æ•™è‚²é£æ ¼": costData.educationStyle,
                        "è´¹ç”¨é¡¹ç›®æ•°": Object.keys(costData.costs).length,
                        "3å¹´æ€»è´¹ç”¨": calculation.totalCost,
                        "å¹´å‡è´¹ç”¨": calculation.yearlyTotal
                    }
                };
                
                result.textContent = JSON.stringify(results, null, 2);
                result.style.color = success ? '#27ae60' : '#e74c3c';
            } catch (error) {
                result.textContent = 'âŒ æµ‹è¯•å¤±è´¥: ' + error.message;
                result.style.color = '#e74c3c';
            }
        }
    </script>
</body>
</html>
